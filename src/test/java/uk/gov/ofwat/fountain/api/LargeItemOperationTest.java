/*
 *  Copyright (C) 2009 Water Services Regulation Authority (Ofwat)
 *
 *  This program is free software; you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation; either version 2 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License along
 *  with this program; if not, write to the Free Software Foundation, Inc.,
 *  51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 */

package uk.gov.ofwat.fountain.api;

import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Vector;

import javax.annotation.Resource;

import junit.framework.Assert;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.AbstractTransactionalJUnit4SpringContextTests;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;

import uk.gov.ofwat.fountain.dao.ItemPropertiesDao;
import uk.gov.ofwat.fountain.domain.ItemProperties;

/**
 * Tests the item properties doa for large operations on the database
 */
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations={"/test_beans.xml"})
public class LargeItemOperationTest extends  AbstractTransactionalJUnit4SpringContextTests{
	@Resource
	private ItemPropertiesDao itemPropertiesDao;
	
	@Test
	public void testLargeItemRead() throws Exception {
		System.out.println("TEST: " + this.getClass().getCanonicalName() + ":testLargeItemRead");
		String[] codes = getItemCodes(); 
		List<ItemProperties> itemProperties = itemPropertiesDao.getForCodes(codes);
		
		Map<String, List<ItemProperties>> ipMap = new HashMap<String, List<ItemProperties>>();
		for (ItemProperties ip : itemProperties) {
			String key = ip.getItem().getCode();
			if (!ipMap.containsKey(key)) {
				ipMap.put(key, new Vector<ItemProperties>());
			}
			ipMap.get(key).add(ip);
		}
		
		testProperties (ipMap, "BN1004P", 3, 0,	4);
		testProperties (ipMap, "BT39200C", 3, 0,0);
	
		System.out.println("TEST: Done");
}
	
	private void testProperties(Map<String, List<ItemProperties>> ipMap, String code, int expectedProperties, int indexToTest, int expectedFormula) {
		List<ItemProperties> l = ipMap.get(code);
		Assert.assertNotNull("No item properties found for " + code, l);
		Assert.assertEquals("wrong number of properties for " + code, expectedProperties, l.size());
		
		ItemProperties ip = l.get(indexToTest);
		Assert.assertEquals("Wrong number of formula found", expectedFormula, ip.getFormulae().size());
	}
	
	private String[] getItemCodes() {
		return new String[] {
				"CPMS4010DESC","SEFNAME01","BM107","BM330","BM830","BM313","BM314","BM814","FDB_OS00025","FDB_CS00020","FDB_CS00036","FDB_BP1940","FDB_CS00040","FDB_CS00120","FDB_OS00100",
				"FDB_CS00330","FDB_OS00280","FDB_CS00210","FDB_GS00010","FDB_CS00220","FDB_OS00190","FDB_BC30989","FDB_OS00300","FDB_BC30992","FDB_BC38991","FDB_BC30492","FDB_BC38491","FDR_OS00025","FDR_CS00020","FDR_CS00036",
				"FDR_BP1940","FDR_CS00040","FDR_CS00120","FDR_OS00100","FDR_CS00330","FDR_OS00280","FDR_CS00210","FDR_GS00010","FDR_CS00220","FDR_OS00190","FDR_BC30989","FDR_OS00300","FDR_BC30992","FDR_BC38991","FDR_BC30492",
				"FDR_BC38491","DD_OS00025","DD_CS00020","DD_CS00036","DD_BP1940","DD_CS00040","DD_CS00120","DD_OS00100","DD_CS00330","DD_OS00280","DD_CS00210","DD_GS00010","DD_CS00220","DD_OS00190","DD_BC30989",
				"DD_OS00300","DD_BC30992","DD_BC38991","DD_BC30492","DD_BC38491","DDP_OS00025","DDP_CS00020","DDP_CS00036","DDP_BP1940","DDP_CS00040","DDP_CS00120","DDP_OS00100","DDP_CS00330","DDP_OS00280","DDP_CS00210",
				"DDP_GS00010","DDP_CS00220","DDP_OS00190","DDP_BC30989","DDP_OS00300","DDP_BC30992","DDP_BC38991","DDP_BC30492","DDP_BC38491","FDB_OW00025","FDB_CW00020","FDB_CW00036","FDB_BP1740","FDB_CW00040","FDB_CW00120",
				"FDB_OW00100","FDB_CW00330","FDB_OW00280","FDB_CW00204","FDB_GW00010","FDB_CW00215","FDB_OW00186","FDB_CW00206","FDB_OW00188","FDB_BC30489","FDB_OW00300","FDR_OW00025","FDR_CW00020","FDR_CW00036","FDR_BP1740",
				"FDR_CW00040","FDR_CW00120","FDR_OW00100","FDR_CW00330","FDR_OW00280","FDR_CW00204","FDR_GW00010","FDR_CW00215","FDR_OW00186","FDR_CW00206","FDR_OW00188","FDR_BC30489","FDR_OW00300","DD_OW00025","DD_CW00020",
				"DD_CW00036","DD_BP1740","DD_CW00040","DD_CW00120","DD_OW00100","DD_CW00330","DD_OW00280","DD_CW00204","DD_GW00010","DD_CW00215","DD_OW00186","DD_CW00206","DD_OW00188","DD_BC30489","DD_OW00300",
				"DDP_OW00025","DDP_CW00020","DDP_CW00036","DDP_BP1740","DDP_CW00040","DDP_CW00120","DDP_OW00100","DDP_CW00330","DDP_OW00280","DDP_CW00204","DDP_GW00010","DDP_CW00215","DDP_OW00186","DDP_CW00206","DDP_OW00188",
				"DDP_BC30489","DDP_OW00300","BO1160","BC11270","GW00010","BC11370","GS00010","CW00204","BC30415","BC30417","CW00330","CW00206","CW00036","BC30445","BC30460",
				"BC30495","BC30497","BC30498","CS00210","BC30915","CS00330","BC30945","CS00036","BC30960","BC30995","BC30997","BC30998","BC31000","BC31010","BC31100",
				"BC31120","CW00120","CS00120","BC31800","BC31830","BC31850","BC31880","BC39100X","BN100","BN1000","BN1001","BN1004","BN1004S","BN1008","BN1008O",
				"BN1037","BN1049","BN1051","BN1053","BN1053O","BN1055","BN1066","BN1067","BN1067O","BN1067T","BN1068","BN1068T","BN1069","BN1069T","BN107",
				"BN1077","BN1078","BN1079","BN108","BN108P","BN1091","BN1093","BN1095","BN1097","BN1098","BN1100","BN1100S","BN1155","BN1160","BN1165P",
				"BN1172","BN1174","BN1176","BN1177","BN1179","BN1180P","BN1181","BN1183","BN1185","BN1186","BN1189","BN1190P","BN1193P","BN1200","BN1204",
				"BN1208","BN1225","BN1230","BN1231","BN1232","BN1233","BN1290","BN1291","BN1292","BN1293","BN1294","BN1295","BN1296","BN1297","BN1299",
				"BN1303","BN1314","BN1320","BN1322","BN1323","BN1324","BN1354","BN1360","BN1374","BN1375","BN1376","BN1377","BN1378","BN1379","BN1381",
				"BN1394","BN1395","BN1396","BN1397","BN1400","BN1400S","BN1406","BN1406S","BN1490","BN1491","BN1492","BN1493","BN1494","BN1495","BN1496",
				"BN1497","BN1506","BN1518","BN1524","BN1542","BN1566","BN1572","BN1590","BN1593","BN1594","BN1595","BN1603","BN1607","BN1621","BN1627",
				"BN1652","BN1654","BN1657","BN1660","BN1662","BN1664","BN1666","BN1668","BN1683","BN1684","BN1686","BN1688","BN1760","BN1762","BN1764",
				"BN200","BN2000","BN2010","BN2020","BN2030","BN2040","BN205","BN2050","BN205P","BN207","BN2100","BN2110","BN2115","BN2120","BN2130",
				"BN2140","BN2150","BN2160","BN2200","BN2210","BN2215","BN2220","BN2230","BN2250","BN2260","BN2270","BN2285","BN2300","BN2304","BN2305",
				"BN2311","BN2312","BN2313","BN2317","BN2320","BN2322","BN2323","BN2324","BN2325","BN2327","BN2330","BN2332","BN2335","BN2340","BN2345",
				"BN2350","BN2360","BN2370","BN2375","BN2430","BN2450","BN2455","BN2457","BN2458","BN2470","BN2479","BN2491","BN2492","BN2493","BN2494",
				"BN2550","BN2560","BN2570","BN2580","BN2590","BN2630","BN2670","BN2680","BN2685","BN2690","BN2699","BN5190","BN530","BN531","BN532",
				"BN535","BN7000A","BN7002","BN7008A","BN7010","BN7016A","BN7018","BN7024A","BN7026","BN7032","BN7034","BN7036","BN7038","BN7040","BN7042",
				"BN7044","BN7060","BN7062","BN7064","BN7066","BN7068","BN7070","BN801","BN812","BN815","BN844","BN845","BN848","BN850","BN865",
				"BN866","BN867","BN868","BN869","BN876","BN879","BN885","BN888","BN889","BN890","BN900","BN908","BN914","BN915","BN916",
				"BN917","BO1980","BO2060","BO2510","BO2520","BO2530","BO2540","BO2960","BO2975","BO3166","BO3200","BO3201","BO3210","BO3220","BO3300",
				"BO3301","BO3305","BO3310","BO3320","BO3351","BO3390","BO3402","BO3490","BO4008","BO4010","BO4035","BO4040","BO4051","BO4052","BO4055",
				"BO4065","BO4070","BO4082","BO4084","BO4086","BO4092","BO4093","BO4095","BO4096","BO4099","BO4100","BO4105","BO4107","BO4110","BO4120",
				"BO4130","BO4208","BO4210","BO4220","BO4270","BO4300","BO4300S","BO4310","BO4354","BO4356","BO4357","BO4370","BO5000","BO5002","BO5020",
				"BO5040","BO5052","BO5054","BO5056","BO5058","BO5060","BO5070","BO5080","BO5081","BO5083","BO5084","BO5086","BO5090","BO5092","BO5093",
				"BO5094","BO5095","BO5096","BO5098","BO5202","BO5204","BO5214","BN4830","BN4831","BN4832","BN4835","BN4836","BN4837","BN4840","BN4841",
				"BN4842","BN4843","BN4844","BN4845","BN4880","BN6318","BN6320","BN6348","BN6350","BN6378","BN6380","BN6408","BN6410","BN6438","BN6440",
				"BN6468T","BN6500T","BM101","BM201","BM301","BM102","BM202","BM302","BM103","BM203","BM303","BM104","BM204","BM304","BM105",
				"BM205","BM305","BM106","BM206","BM306","BM140","BM240","BM340","BM108","BM208","BM308","BM109","BM209","BM309","BM110",
				"BM210","BM310","BM111","BM211","BM311","BM341","BM342","BM343","BM344","BM317","BM318","BM319","BM345","BM323","BM351",
				"BM146","BM246","BM346","BM147","BM247","BM347","BM112","BM212","BM312","BM348","BM320","BM321","BM349","BM350","BM324",
				"BM401","BM501","BM601","BM801","BM402","BM502","BM602","BM802","BM403","BM503","BM603","BM803","BM404","BM504","BM604",
				"BM804","BM405","BM505","BM605","BM805","BM406","BM506","BM606","BM806","BM408","BM508","BM608","BM808","BM409","BM509",
				"BM609","BM809","BM410","BM510","BM610","BM810","BM411","BM511","BM611","BM811","BM840","BM841","BM842","BM843","BM817",
				"BM818","BM819","BM844","BM823","BM850","BM446","BM546","BM646","BM846","BM447","BM547","BM647","BM847","BM412","BM512",
				"BM612","BM812","BM848","BM820","BM821","BM851","BM849","BM824","BO1101","BO1120","BO1122","BO1110","BO1130","BO1131","BO1140",
				"BO1141","BO1150","BO1155","BO1156","BO1194","BO1195","BO1196","BO1181","BO1182","BO1180","BO2992","BO2994","BO2995","BR940","BR945",
				"BR946","BR970","BR971","BR972","BO3070","BO3080","BO3090","BO3000","BO3050","BO3060","BM4000","BM4100","BM4200","BM4300","BM4400",
				"BM4500","BM4600","BM4700","BM4800","BM4010","BM4110","BM4210","BM4310","BM4410","BM4510","BM4610","BM4710","BM4810","BM4020","BM4120",
				"BM4220","BM4320","BM4420","BM4520","BM4620","BM4720","BM4820","BM4030","BM4130","BM4230","BM4330","BM4430","BM4530","BM4630","BM4730",
				"BM4830","BM4040","BM4140","BM4240","BM4340","BM4440","BM4540","BM4640","BM4740","BM4840","BM4050","BM4150","BM4250","BM4350","BM4450",
				"BM4550","BM4650","BM4750","BM4850","BM4155","BM4255","BM4355","BM4555","BM4655","BM4755","BM4855","BM4160","BM4260","BM4360","BM4560",
				"BM4660","BM4760","BM4860","BM4165","BM4265","BM4365","BM4565","BM4665","BM4765","BM4865","BM4170","BM4270","BM4370","BM4570","BM4670",
				"BM4770","BM4870","BM4175","BM4275","BM4375","BM4575","BM4675","BM4775","BM4875","BM4180","BM4280","BM4380","BM4580","BM4680","BM4780",
				"BM4880","BM4185","BM4285","BM4385","BM4585","BM4685","BM4785","BM4885","BM4190","BM4290","BM4390","BM4590","BM4690","BM4790","BM4890",
				"BM4095","BM4195","BM4295","BM4395","BM4495","BM4595","BM4695","BM4795","BM4895","BM4099","BM4199","BM4299","BM4399","BM4499","BM4599",
				"BM4699","BM4799","BM4899","BM10000","BM10010","BM10020","BM10030","BM10060","BM10100","BM10110","BM10120","BM10130","BM10160","BM10200","BM10210",
				"BM10220","BM10230","BM10260","BC18700W","BC18710W","BC18720W","BC18730W","BC18740W","BC11060","BC11065","BC18750W","BC18700S","BC18710S","BC18720S","BC18730S",
				"BC18740S","BC11160","BC11165","BC18750S","BC18800W","BC18810W","BC18820W","BC18830W","BC18840W","BC18850W","BC18800S","BC18810S","BC18820S","BC18830S","BC18840S",
				"BC18850S","BC18100","BC18110","BC18120","BC18130","BC11430","BC18600","BC18610","BC18620","BC18630","BC11460","CPMS4010","CPMS4020","CPMS4030","CPMS4040",
				"BM5000","BM5005","BM5012","BM5035","BM5040","BM5042","BM5047","BM5055","BM5077","BM5082","BM5900","BM5902","BM5905","BM5907","BM5910",
				"BM5912","BM5937","BM5939","BM5942","BM5945","BM5947","BM5950","BM5952","BM5955","BM5980","BM5982","BM5300","BM5302","BM5305","BM5307",
				"BM5310","BM5312","BM5335","BM5337","BM5339","BM5342","BM5345","BM5347","BM5350","BM5352","BM5355","BM5377","BM5380","BM5382","BM5415",
				"BM5417","BM5425","BM5432","BM5435","BM5440","BM5457","BM5460","BM5467","BM5475","BM5477","BM5482","BM6715","BM6717","BM6720","BM6722",
				"BM6725","BM6727","BM6730","BM6732","BM6737","BM6740","BM6757","BM6760","BM6762","BM6765","BM6767","BM6770","BM6772","BM6775","BM6780",
				"BM6782","BM5715","BM5717","BM5720","BM5722","BM5725","BM5727","BM5730","BM5732","BM5735","BM5737","BM5740","BM5757","BM5760","BM5762",
				"BM5765","BM5767","BM5770","BM5772","BM5775","BM5777","BM5780","BM5782","BM5800","BM5802","BM5805","BM5807","BM5810","BM5812","BM5815",
				"BM5817","BM5820","BM5822","BM5825","BM5827","BM5830","BM5832","BM5835","BM5837","BM5840","BM5842","BM5845","BM5847","BM5850","BM5852",
				"BM5855","BM5857","BM5860","BM5862","BM5865","BM5867","BM5870","BM5872","BM5875","BM5877","BM5880","BM5882","BN1004P","BP200","BN109P",
				"BP300","BO4075","BR16050","BP701","BP746","BP708","BP741","BP751","BN1239","BN1149","BN7031","BP801","BP816","BP826","BP836",
				"BP846","BP808","BP821","BP831","BP841","BP851","BN1597","BN1598","BN1599","BP475","BO5003","BC20000","BC20002","BC20006","BC20008",
				"BC20010","BC20012","BC20014","BC20016","BC20020","BC20022","BC20024","BC20026","BC20028","BC20030","BC20034","BC20036","BC20038","BC20040","BC20056",
				"BC20058","BC20062","BC20064","BC20066","BC20068","BC20070","BC21000","BC21002","BC21006","BC21008","BC21010","BC21012","BC21014","BC21016","BC21020",
				"BC21022","BC21024","BC21026","BC21028","BC21030","BC21034","BC21036","BC21038","BC21040","BC21056","BC21058","BC21062","BC21064","BC21066","BC21068",
				"BC21070","BN1234","CW00215","BC30489","OW00300","CS00220","BC30989","OS00300","BT3099N","BT3099C","BT3099P","BT30199N","BT30199C","BT30199P","BT30299N",
				"BT30299C","BT30299P","BT30300N","BT30300C","BT30300P","BT3199N","BT3199C","BT3199P","BT31199N","BT31199C","BT31199P","BT31299N","BT31299C","BT31299P","BT31300N",
				"BT31300C", "BT31300P","BT39100G","BT39100V","BT391001","BT391002","BT391003","BT391004","BT39100P","BT39200C",		
				};	
		}
}
